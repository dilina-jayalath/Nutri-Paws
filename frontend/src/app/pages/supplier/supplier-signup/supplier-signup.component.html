<div class="signup-container">
  <!-- Modern floating back button -->
  <button mat-fab extended color="primary" class="back-button" routerLink="/supplier">
    <mat-icon>arrow_back</mat-icon>
    Back
  </button>

  <div class="profile-card">
    <div class="profile-header">
      <div class="header-content">
        <div class="title-section">
          <h1>Supplier Registration</h1>
          <p class="subtitle">Create your supplier account to start listing products</p>
        </div>
      </div>
    </div>

    <div class="profile-content">
      <div class="profile-sidebar">
        <div class="user-card">
          <div class="avatar-container">
            <div class="avatar-wrapper">
              <div class="avatar-circle">
                <mat-icon class="avatar-icon">business</mat-icon>
              </div>
              <div class="avatar-edit">
                <mat-icon class="edit-icon">photo_camera</mat-icon>
                <!-- <input type="file" accept="image/*" (change)="onFileSelected($event)" class="file-input"> -->
              </div>
            </div>
            <h2 class="user-name">{{ signupForm.value.companyName }}</h2>
            <p class="user-email">{{ signupForm.value.email }}</p>
          </div>

          <div class="stats-container">
            <div class="stat-item">
              <div class="stat-icon-wrapper">
                <mat-icon class="stat-icon">store</mat-icon>
              </div>
              <div class="stat-info">
                <div class="stat-value">Supplier</div>
                <div class="stat-label">Account Type</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="profile-details">
        <form [formGroup]="signupForm" (ngSubmit)="onSignup()" class="profile-form">
          <!-- Company Information Section -->
          <div class="form-section">
            <div class="section-header">
              <mat-icon class="section-icon">business</mat-icon>
              <h3>Company Information</h3>
            </div>
            <div class="form-grid">
              <mat-form-field appearance="outline" class="form-field">
                <mat-label>Company Name</mat-label>
                <input matInput formControlName="companyName" required>
                <mat-icon matSuffix>business</mat-icon>
                <mat-error *ngIf="signupForm.get('companyName')?.hasError('required')">
                  Company name is required
                </mat-error>
              </mat-form-field>

              <mat-form-field appearance="outline" class="form-field">
                <mat-label>Business Registration Number</mat-label>
                <input matInput formControlName="registrationNumber" required>
                <mat-icon matSuffix>assignment</mat-icon>
                <mat-error *ngIf="signupForm.get('registrationNumber')?.hasError('required')">
                  Registration number is required
                </mat-error>
              </mat-form-field>
            </div>
          </div>

          <!-- Contact Information Section -->
          <div class="form-section">
            <div class="section-header">
              <mat-icon class="section-icon">person</mat-icon>
              <h3>Contact Information</h3>
            </div>
            <div class="form-grid">
              <mat-form-field appearance="outline" class="form-field">
                <mat-label>First Name</mat-label>
                <input matInput formControlName="fName" required>
                <mat-icon matSuffix>badge</mat-icon>
                <mat-error *ngIf="signupForm.get('fName')?.hasError('required')">
                  First name is required
                </mat-error>
                <mat-error *ngIf="signupForm.get('fName')?.hasError('pattern')">
                  Only letters are allowed
                </mat-error>
              </mat-form-field>

              <mat-form-field appearance="outline" class="form-field">
                <mat-label>Last Name</mat-label>
                <input matInput formControlName="lName" required>
                <mat-icon matSuffix>badge</mat-icon>
                <mat-error *ngIf="signupForm.get('lName')?.hasError('required')">
                  Last name is required
                </mat-error>
                <mat-error *ngIf="signupForm.get('lName')?.hasError('pattern')">
                  Only letters are allowed
                </mat-error>
              </mat-form-field>

              <mat-form-field appearance="outline" class="form-field">
                <mat-label>Email</mat-label>
                <input matInput formControlName="email" type="email" required>
                <mat-icon matSuffix>email</mat-icon>
                <mat-error *ngIf="signupForm.get('email')?.hasError('required')">
                  Email is required
                </mat-error>
                <mat-error *ngIf="signupForm.get('email')?.hasError('email')">
                  Please enter a valid email
                </mat-error>
              </mat-form-field>

              <mat-form-field appearance="outline" class="form-field">
                <mat-label>Phone</mat-label>
                <input matInput formControlName="phone" required>
                <mat-icon matSuffix>phone</mat-icon>
                <mat-error *ngIf="signupForm.get('phone')?.hasError('required')">
                  Phone number is required
                </mat-error>
              </mat-form-field>
            </div>
          </div>

          <!-- Address Section -->
          <div class="form-section">
            <div class="section-header">
              <mat-icon class="section-icon">home</mat-icon>
              <h3>Business Address</h3>
            </div>
            <mat-form-field appearance="outline" class="form-field full-width">
              <mat-label>Street Address</mat-label>
              <textarea matInput formControlName="address" required rows="2"></textarea>
              <mat-error *ngIf="signupForm.get('address')?.hasError('required')">
                Address is required
              </mat-error>
            </mat-form-field>
          </div>

          <!-- Account Security Section -->
          <div class="form-section">
            <div class="section-header">
              <mat-icon class="section-icon">lock</mat-icon>
              <h3>Account Security</h3>
            </div>
            <div class="form-grid">
              <mat-form-field appearance="outline" class="form-field">
                <mat-label>Username</mat-label>
                <input matInput formControlName="username" required>
                <mat-icon matSuffix>alternate_email</mat-icon>
                <mat-error *ngIf="signupForm.get('username')?.hasError('required')">
                  Username is required
                </mat-error>
                <mat-error *ngIf="signupForm.get('username')?.hasError('minlength')">
                  Username must be at least 3 characters
                </mat-error>
                <mat-error *ngIf="signupForm.get('username')?.hasError('pattern')">
                  Only letters are allowed
                </mat-error>
              </mat-form-field>

              <mat-form-field appearance="outline" class="form-field">
                <mat-label>Password</mat-label>
                <input matInput [type]="hidePassword ? 'password' : 'text'" formControlName="password" required>
                <button mat-icon-button matSuffix (click)="togglePasswordVisibility()" type="button">
                  <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
                </button>
                <mat-hint>At least 8 characters with a number and special character</mat-hint>
                <mat-error *ngIf="signupForm.get('password')?.hasError('required')">
                  Password is required
                </mat-error>
                <mat-error *ngIf="signupForm.get('password')?.hasError('pattern')">
                  Password must contain at least one number and one special character
                </mat-error>
                <mat-error *ngIf="signupForm.get('password')?.hasError('minlength')">
                  Password must be at least 8 characters
                </mat-error>
              </mat-form-field>

              <mat-form-field appearance="outline" class="form-field">
                <mat-label>Confirm Password</mat-label>
                <input matInput [type]="hideConfirmPassword ? 'password' : 'text'" formControlName="confirmPassword" required>
                <button mat-icon-button matSuffix (click)="toggleConfirmPasswordVisibility()" type="button">
                  <mat-icon>{{ hideConfirmPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
                </button>
                <mat-error *ngIf="signupForm.get('confirmPassword')?.hasError('required')">
                  Please confirm your password
                </mat-error>
                <mat-error *ngIf="signupForm.hasError('passwordMismatch')">
                  Passwords do not match
                </mat-error>
              </mat-form-field>
            </div>
          </div>

          <!-- Terms and Conditions -->
          <div class="form-section">
            <mat-checkbox formControlName="terms" required class="terms-checkbox">
              I agree to the <a href="#" class="text-link">Terms and Conditions</a> and
              <a href="#" class="text-link">Supplier Agreement</a>
            </mat-checkbox>
            <mat-error *ngIf="signupForm.get('terms')?.hasError('required')" class="checkbox-error">
              You must accept the terms and conditions
            </mat-error>
          </div>

          <!-- Submit Button -->
          <div class="form-section submit-section">
            <button mat-raised-button color="primary" class="submit-button" type="submit" [disabled]="isLoading">
              <span *ngIf="!isLoading">Register as Supplier</span>
              <mat-spinner *ngIf="isLoading" diameter="24" strokeWidth="3"></mat-spinner>
            </button>
            <div class="login-prompt">
              Already have an account? <a (click)="openLogin()" class="text-link">Sign in</a>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<ng-template #loading>
  <div class="loading-container">
    <mat-spinner diameter="64" color="accent"></mat-spinner>
    <p>Processing your registration...</p>
  </div>
</ng-template>
